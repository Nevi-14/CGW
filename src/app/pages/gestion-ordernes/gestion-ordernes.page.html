
 <ion-toolbar   >
   <ion-row>
      <ion-col size="7">
         <ion-row>
            <ion-col size="6" class="ion-text-center">
               <ion-item *ngIf="ordenCompra" lines="none">
                  <ion-label><strong><h2>    ORDEN DE COMPRA </h2></strong></ion-label>
                  <ion-badge    color="warning"  mode="ios">{{ordenCompra.ORDEN_COMPRA}}</ion-badge>
               </ion-item>
       <ion-item *ngIf="ordenCompra" lines="none">
         <ion-label style="margin-right: 0.5rem;">ESTADO</ion-label>
         <ion-badge color="dark"  mode="ios">{{estadoOrden()}}</ion-badge>
       </ion-item>
            </ion-col>
   
            <ion-col size="6">
               <ion-row class="dark-header">
                  <ion-col size="4">
      Dia
                  </ion-col>
                  <ion-col size="4">
                     Mes
                  </ion-col>
                  <ion-col size="4">
                     Año
                  </ion-col>
               </ion-row>
               <ion-row class="row-text-center">
                  <ion-col size="4">
      {{date}}
                  </ion-col>
                  <ion-col size="4">
                     {{month}}
                  </ion-col>
                  <ion-col size="4">
                     {{year}}
                  </ion-col>
               </ion-row>
            </ion-col>
         </ion-row>
      </ion-col>
   
      <ion-col size="5">
         
   <ion-item lines="none">
      <ion-fab-button *ngIf="actualizar && ordenCompra.ESTADO == 'A'" slot="end" size="small" color="dark"  (click)="actualizarEstado()">
         <ion-icon name="create-outline"></ion-icon>
       </ion-fab-button>
   <ion-fab-button *ngIf="articulosService.articulosPostArray.length > 0 &&  ordenCompra.ESTADO == 'A'" slot="end" size="small" color="dark"  (click)="generarPost()">
     <ion-icon name="save"></ion-icon>
   </ion-fab-button>
   <ion-fab-button  *ngIf="ordenCompra.ESTADO == 'A'" slot="end" size="small" color="dark" (click)="listaProveedores()">
     <ion-icon name="settings"></ion-icon>
   </ion-fab-button>
   <ion-fab-button  *ngIf="ordenCompra.ESTADO == 'B'" slot="end" size="small" color="dark" (click)="consultarAprobadores()">
      <ion-icon name="people"></ion-icon>
    </ion-fab-button>
    
   <ion-fab-button *ngIf="usuariosService.usuario.UsuarioExactus == 'GCOMPRAS'" slot="end" size="small" color="dark" (click)="consultarOrdenesEstado()">
     <ion-icon name="search"></ion-icon>
   </ion-fab-button>
   
   <ion-fab-button slot="end" size="small" color="dark" (click)="limpiarDatos()">
     <ion-icon name="reload"></ion-icon>
   </ion-fab-button>
   <ion-fab-button slot="end" size="small" color="dark" (click)="salir()">
     <ion-icon name="exit"></ion-icon>
   </ion-fab-button>
   </ion-item>
      </ion-col>
           
   </ion-row>
</ion-toolbar>



<ion-content >

  
   <ion-card  class="ion-margin" *ngIf="proveedor">
     <ion-item color="dark"  >
        <ion-label slot="start"><strong><h2>DETALLE PROVEEDOR</h2></strong></ion-label>
        
     </ion-item>
     <ion-card-content>
  
  
  
  

        <ion-row *ngIf="proveedor" class="ion-margin">
           <ion-col size="4" >
     
               <ion-row>
                 <ion-col size="12">
                    <ion-label><h2>Proveedor : {{proveedor.NOMBRE}}</h2></ion-label>
                 
                 </ion-col>
     
                
           
           </ion-row>
                    </ion-col>
     
                    <ion-col size="4">
                       <ion-row>
                          <ion-col size="12">
                             <ion-label>Dirección : {{proveedor.DIRECCION}}</ion-label>
                          </ion-col>
                          <ion-col size="12">
                             <ion-label>Correo : {{proveedor.E_MAIL}}</ion-label>
                          </ion-col>
                          <ion-col size="12">
                             <ion-label>Telefono : {{proveedor.TELEFONO1}}</ion-label>
                          </ion-col>
                       </ion-row>
                    </ion-col>
                    <ion-col size="4">
                      <ion-row>
                         <ion-col size="12">
                            <ion-label>Proforma # :</ion-label>
                         </ion-col>
              
                         <ion-col size="12">
                            <ion-label>Codigo Postal : </ion-label>
                         </ion-col>
                         <ion-col size="12">
                            <ion-label>Contacto : </ion-label>
                         </ion-col>
                         <ion-col size="12">
                            <ion-label>Incoterm : </ion-label>
                         </ion-col>
                   
                      </ion-row>
                    </ion-col>
            
     
         </ion-row>

  
  
     </ion-card-content>
    </ion-card>
 <ion-card  class="ion-margin">
  <ion-item color="dark"  >
     <ion-label slot="start"><strong><h2>DETALLES GENERALES</h2></strong></ion-label>
     <ion-badge slot="end" color="primary" mode="ios" >LISTA BODEGAS</ion-badge>
  <ion-fab-button *ngIf="ordenCompra.ESTADO == 'A'" slot="end"  (click)="listaBodegas()" color="primary" size="small">
     <ion-icon name="add"></ion-icon>
  </ion-fab-button>
  </ion-item>
  <ion-card-content>




<ion-row class="ion-padding-top">

   <ion-col size="2">
     <ion-label>USUARIO</ion-label>
     <ion-item lines="none">
        <ion-input readonly type="text" placeholder="usuario" [(ngModel)]="ordenCompra.USUARIO"></ion-input>
       </ion-item>
   </ion-col>



   <ion-col size="2">
     <ion-label>PROVEEDOR</ion-label>
     <ion-item lines="none">
        <ion-input readonly  type="text" placeholder="proveedor" [(ngModel)]="ordenCompra.PROVEEDOR"></ion-input>
       </ion-item>
   </ion-col>

   <ion-col size="2">
     <ion-label>BODEGA</ion-label>
     <ion-item lines="none">
        <ion-input readonly type="text"  placeholder="bodega" [(ngModel)]="ordenCompra.BODEGA"></ion-input>
       </ion-item>
   </ion-col>

   <ion-col size="2">
     <ion-label>CONDICION PAGO</ion-label>
     <ion-item lines="none">
        <ion-input readonly type="text" placeholder="bodega" [(ngModel)]="ordenCompra.CONDICION_PAGO"></ion-input>
       </ion-item>
   </ion-col>
   <ion-col size="2">
     <ion-label>MONEDA</ion-label>
     <ion-item lines="none">
        <ion-input readonly type="text" placeholder="moneda" [(ngModel)]="ordenCompra.MONEDA"></ion-input>
       </ion-item>
   </ion-col>

   <ion-col size="2">
     <ion-label>PAIS</ion-label>
     <ion-item lines="none">
        <ion-input readonly type="text" placeholder="pais"[(ngModel)]="ordenCompra.PAIS"></ion-input>
       </ion-item>
   </ion-col>

</ion-row >


     <ion-row class="ion-padding-top">
      <ion-col size="2">
         <ion-label>FECHA REQUERIDA</ion-label>
         <ion-item lines="none">
            <ion-input readonly type="text" placeholder="fecha requerida"[(ngModel)]="ordenCompra.FECHA_REQUERIDA"   (click)="fechaOrdenCompra(ordenCompra,'FECHA_REQUERIDA')" [ngModel]="ordenCompra.FECHA_REQUERIDA | date" 
            (ngModelChange)="ordenCompra.FECHA_REQUERIDA=$event"></ion-input>
           </ion-item>
       </ion-col>
       <ion-col size="2"  *ngIf="actualizar">
         <ion-label>FECHA APROBACION</ion-label>
         <ion-item lines="none">
            <ion-input readonly type="text" placeholder="fecha aprobacion"[(ngModel)]="ordenCompra.FECHA_APROBACION"  (click)="fechaOrdenCompra(ordenCompra,'FECHA_APROBACION')" [ngModel]="ordenCompra.FECHA_APROBACION | date" 
            (ngModelChange)="ordenCompra.FECHA_APROBACION=$event"></ion-input>
           </ion-item>
       </ion-col>
       <ion-col size="2" *ngIf="actualizar">
         <ion-label>FECHA ARRIBO</ion-label>
         <ion-item lines="none">
            <ion-input readonly type="text" placeholder="fecha arribo"[(ngModel)]="ordenCompra.FECHA_ARRIBO"   (click)="fechaOrdenCompra(ordenCompra,'FECHA_ARRIBO')" [ngModel]="ordenCompra.FECHA_ARRIBO | date" 
            (ngModelChange)="ordenCompra.FECHA_ARRIBO=$event"></ion-input>
           </ion-item>
       </ion-col>
       <ion-col size="2" *ngIf="actualizar">
         <ion-label>FECHA CIERRE</ion-label>
         <ion-item lines="none">
            <ion-input readonly type="text" placeholder="fecha cierre"[(ngModel)]="ordenCompra.FECHA_CIERRE"     (click)="fechaOrdenCompra(ordenCompra,'FECHA_CIERRE')" [ngModel]="ordenCompra.FECHA_CIERRE | date" 
            (ngModelChange)="ordenCompra.FECHA_CIERRE=$event"></ion-input>
           </ion-item>
       </ion-col>
       <ion-col size="2" *ngIf="actualizar">
         <ion-label>FECHA COTIZACION</ion-label>
         <ion-item lines="none">
            <ion-input readonly type="text" placeholder="fecha cotizacion"[(ngModel)]="ordenCompra.FECHA_COTIZACION"    (click)="fechaOrdenCompra(ordenCompra,'FECHA_COTIZACION')" [ngModel]="ordenCompra.FECHA_COTIZACION | date" 
            (ngModelChange)="ordenCompra.FECHA_COTIZACION=$event"></ion-input>
           </ion-item>
       </ion-col>
   
       <ion-col size="2" *ngIf="actualizar">
         <ion-label>FECHA DESALMACENAJE</ion-label>
         <ion-item lines="none">
            <ion-input readonly type="text" placeholder="fecha desalmacenaje"[(ngModel)]="ordenCompra.FECHA_DESALMACENAJE"   (click)="fechaOrdenCompra(ordenCompra,'FECHA_DESALMACENAJE')" [ngModel]="ordenCompra.FECHA_DESALMACENAJE | date" 
            (ngModelChange)="ordenCompra.FECHA_DESALMACENAJE=$event"></ion-input>
           </ion-item>
       </ion-col>
       <ion-col size="2" *ngIf="actualizar">
         <ion-label>FECHA EMBARQUE</ion-label>
         <ion-item lines="none">
            <ion-input  readonly type="text" placeholder="fecha embarque"[(ngModel)]="ordenCompra.FECHA_EMBARQUE"    (click)="fechaOrdenCompra(ordenCompra,'FECHA_EMBARQUE')"  [ngModel]="ordenCompra.FECHA_EMBARQUE | date" 
            (ngModelChange)="ordenCompra.FECHA_EMBARQUE=$event"></ion-input>
           </ion-item>
       </ion-col>
       
       <ion-col size="2" *ngIf="actualizar">
         <ion-label>INSTRUCCIONES</ion-label>
         <ion-item lines="none">
            <ion-input readonly="{{ordenCompra.ESTADO == 'A' ? false : true }}"   type="text" placeholder="instrucciones" [(ngModel)]="ordenCompra.INSTRUCCIONES"></ion-input>
           </ion-item>
       </ion-col>
         <ion-col size="2">
           <ion-label>% DESCUENTO</ion-label>
           <ion-item lines="none">
              <ion-input readonly="{{ordenCompra.ESTADO == 'A' ? false : true }}"  (ionInput)="setDescuentoOrden($event)" type="number" placeholder="descuento" [(ngModel)]="ordenCompra.PORC_DESCUENTO"></ion-input>
             </ion-item>
         </ion-col>
         <ion-col size="2">
           <ion-label>MONTO DESCUENTO</ion-label>
           <ion-item lines="none">
              <ion-input readonly type="text" placeholder="monto descuento" [(ngModel)]="ordenCompra.MONTO_DESCUENTO"></ion-input>
             </ion-item>
         </ion-col>
         <ion-col size="2">
           <ion-label>MONTO FLETE</ion-label>
           <ion-item lines="none">
              <ion-input readonly="{{ordenCompra.ESTADO == 'A' ? false : true }}"   (ionInput)="setFlete($event)"   type="number" placeholder="monto flete" [(ngModel)]="ordenCompra.MONTO_FLETE"></ion-input>
             </ion-item>
        </ion-col>
        <ion-col size="2">
           <ion-label>SEGURO</ion-label>
           <ion-item lines="none">
              <ion-input readonly="{{ordenCompra.ESTADO == 'A' ? false : true }}"  (ionInput)="setSeguro($event)" type="text" placeholder="monto seguro" [(ngModel)]="ordenCompra.MONTO_SEGURO"></ion-input>
             </ion-item>
        </ion-col>
        <ion-col size="2">
           <ion-label>ANTICIPO</ion-label>
           <ion-item lines="none">
              <ion-input readonly="{{ordenCompra.ESTADO == 'A' ? false : true }}"  (ionInput)="setAnticipo($event)"  type="text" placeholder="monto anticipo" [(ngModel)]="ordenCompra.MONTO_ANTICIPO"></ion-input>
             </ion-item>
        </ion-col>
     </ion-row>


  </ion-card-content>
 </ion-card>


 <ion-card style="margin-top: 6rem;" class="ion-margin">

  <ion-item color="dark"  >
     <ion-label slot="start"><strong><h2>LISTA DE ARTICULOS      <ion-badge  color="warning" mode="ios">{{articulosService.articulosPostArray.length}}</ion-badge></h2></strong></ion-label>

     <ion-searchbar color="light" class="ion-margin-top"   mode="ios" style="max-width:40vw"  inputmode="text"  debounce="250" placeholder="Buscar Articulo" (ionChange)="onSearchChange($event)" ></ion-searchbar>
     <ion-badge slot="end" color="primary" mode="ios" >ARTICULOS</ion-badge>
  <ion-fab-button *ngIf="ordenCompra.ESTADO == 'A'" slot="end"  (click)="listaArticulos()" color="primary" size="small">
     <ion-icon name="add"></ion-icon>
  </ion-fab-button>

  
  </ion-item>





 <ion-card-content class="ion-padding">

  <div style="overflow-x:auto;">
     <table style="width: 100%; margin:1rem" class="ion-padding">
   <thead >
     <th style="min-width:120px;">ARTICULO</th>
     <th style="min-width:200px;">DESCRIPCION</th>
     <th style="min-width:120px;">PRECIO</th>
     <th style="min-width:120px;">UNIDADES</th>
     <th style="min-width:120px;">% IMPUESTO</th>
     <th style="min-width:120px;">% DESCUENTO</th>
     <th style="min-width:200px;">MONTO IMPUESTO</th>
     <th style="min-width:200px;">MONTO DESCUENTO</th>
     <th style="min-width:200px;">PRECIO DESCUENTO</th>
     <th style="min-width:200px;">TOTAL</th>
    <th *ngIf="ordenCompra.ESTADO == 'A'"></th>
   </thead>
<tbody>
  <tr *ngFor="let articulo of articulosService.articulosPostArray | filtro: textoBuscar:'ARTICULO' ; let odd = odd; let i = index; " [ngClass]="odd ? 'odd' : 'even'">
     <td>
       
       <ion-input readonly="true"   type="text" placeholder="articulo" [(ngModel)]="articulo.articulo.ARTICULO"></ion-input>
       
</td>
     <td>
    
       <ion-input readonly="true"   type="text" placeholder="descripcion" [(ngModel)]="articulo.articulo.DESCRIPCION"></ion-input></td>

       <td><ion-input readonly="{{ordenCompra.ESTADO == 'A' ? false : true }}"  (ionInput)="setPrecio($event,articulo)"   type="number" placeholder="precio" [(ngModel)]="articulo.articulo.PRECIO_UNITARIO"></ion-input></td>
       
     <td><ion-input readonly="{{ordenCompra.ESTADO == 'A' ? false : true }}"  (ionInput)="setUnidades($event,articulo)"  type="number" placeholder="Unidades" [(ngModel)]="articulo.articulo.CANTIDAD_ORDENADA"></ion-input></td>
     <td><ion-input  readonly="{{ordenCompra.ESTADO == 'A' ? false : true }}"   (ionInput)="setImpuesto($event,articulo)"    type="number" placeholder="impuesto 1" [(ngModel)]="articulo.articulo.IMPUESTO1"    [ngModel]="articulo.articulo.IMPUESTO1" (ngModelChange)="onInputChange($event)" ></ion-input></td>
     <td><ion-input readonly="{{ordenCompra.ESTADO == 'A' ? false : true }}"  (ionInput)="setDescuento($event,articulo)"   type="number" placeholder="descuento" min="0"    [(ngModel)]="articulo.articulo.PORC_DESCUENTO"    ></ion-input></td>
     <td><ion-input  readonly="true"   type="text" placeholder="monto impuesto"  [ngModel]="articulo.montoImpuesto | colones" (ngModelChange)="articulo.montoImpuesto = $event"  ></ion-input></td>
     <td><ion-input  readonly="true"   type="text" placeholder="monto descuento"  [ngModel]="articulo.articulo.MONTO_DESCUENTO | colones" (ngModelChange)="articulo.articulo.MONTO_DESCUENTO = $event"  ></ion-input></td>
     <td><ion-input  readonly="true"  type="text" placeholder="precio descuento"    [ngModel]="articulo.precioDescuento | colones" (ngModelChange)="articulo.precioDescuento = $event" ></ion-input></td>

     <td><ion-input  readonly="true" type="text" placeholder="Total" [ngModel]="articulo.Total | colones" (ngModelChange)="articulo.Total = $event"  ></ion-input></td>
     
   
    <td *ngIf="ordenCompra.ESTADO == 'A'">
       <ion-button size="large"   (click)="borrarArticulo(i, articulo)" fill="clear" >
       <ion-icon size="large"  name="trash-outline" color="danger"></ion-icon>
       </ion-button>
    </td>
     

   </tr>
</tbody>



     </table>

    
   </div>
   
  
      <ion-toolbar  *ngIf="articulosService.articulosPostArray.length > 0" class="ion-padding ion-margin-top">
         <ion-row>
            <ion-col size="12" size-md="2">
               <ion-label>UNIDADES TOTALES</ion-label>
               <ion-item lines="none">
                <ion-label>{{TOTAL_UNIDADES}}</ion-label>
             </ion-item>
     
            </ion-col>
            <ion-col size="12" size-md="3">
               <ion-label>DESC SOBRE LA ORDEN</ion-label>

               <ion-item lines="none">
                  <ion-label>{{ordenCompra.MONTO_DESCUENTO  | colones}}</ion-label>
               </ion-item>
            </ion-col>
            <ion-col size="12" size-md="2">
               <ion-label>TOTAL IMPUESTOS</ion-label>
               <ion-item lines="none">
                   <ion-label>{{ordenCompra.TOTAL_IMPUESTO1  | colones}}</ion-label>
                </ion-item>
            </ion-col>
            <ion-col size="12" size-md="2">
               <ion-label>TOTAL MERCADERIA</ion-label>
               <ion-item lines="none">
                  <ion-label>{{ordenCompra.TOTAL_MERCADERIA  | colones}}</ion-label>
               </ion-item>
            </ion-col>
       
            <ion-col size="12" size-md="3">
               <ion-label>TOTAL COMPRAR</ion-label>
     
               <ion-item lines="none">
                  <ion-label>{{ordenCompra.TOTAL_A_COMPRAR  | colones}}</ion-label>
               </ion-item>
            </ion-col>
         </ion-row>
      </ion-toolbar>
 
 
 </ion-card-content>
</ion-card>

</ion-content>
